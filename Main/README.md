# Task Management API

## Описание

Task Management API — это RESTful API для управления задачами, пользователями, категориями и комментариями. Он позволяет выполнять CRUD-операции над сущностями, связанными с задачами, включая добавление, обновление и удаление записей.

## Структура проекта

Проект организован по архитектуре, разделяющей ответственность между различными слоями:

- **Domain**: Содержит бизнес-логические сущности (например, `User`, `Task`, `Comment` и т.д.) и правила, управляющие ими. Здесь определяются основные классы, представляющие данные, с которыми работает приложение.

- **Infrastructure**: Содержит реализацию доступа к данным, включая репозитории и взаимодействие с базой данных. Здесь находятся классы, реализующие интерфейсы репозиториев и осуществляющие CRUD-операции с использованием Dapper.

- **MainApp**: Основное приложение, которое объединяет все компоненты, предоставляет RESTful API и управляет маршрутизацией запросов. Здесь определяются контроллеры и маршруты для обработки HTTP-запросов от клиентов.

## Технологии

- **Язык программирования**: C#
- **База данных**: PostgreSQL
- **ORM**: Dapper

## Структура проекта

### Сущности

- **User**: Представляет пользователя.
- **Category**: Представляет категорию задач.
- **Task**: Представляет задачу, связанную с пользователем и категорией.
- **Comment**: Представляет комментарий к задаче.
- **TaskAttachment**: Представляет вложение к задаче.
- **TaskHistory**: Представляет историю изменений задачи.

### Репозитории

Каждая сущность имеет свой репозиторий для выполнения CRUD-операций:

- **IUserRepository**
- **ICategoryRepository**
- **ITaskRepository**
- **ICommentRepository**
- **ITaskAttachmentRepository**
- **ITaskHistoryRepository**

## API - GET Запросы

### 1. Получение пользователей с задачами

**Запрос:** `GET /api/users`

**Описание:** Возвращает список всех пользователей вместе с их задачами. В ответе предоставляется информация о каждом пользователе и его связанных задачах.

---

### 2. Получение категорий с количеством задач

**Запрос:** `GET /api/categories`

**Описание:** Возвращает список категорий вместе с количеством задач в каждой категории. Это позволяет быстро увидеть, сколько задач относится к каждой категории.

---

### 3. Получение задач по приоритету

**Запрос:** `GET /api/tasks/priority/{priority}`

**Описание:** Получает задачи, отфильтрованные по указанному приоритету. Пример приоритетов: 1 - высокий, 2 - средний, 3 - низкий.

---

### 4. Получение задач с пользователем и категорией

**Запрос:** `GET /api/tasks/with-user-category`

**Описание:** Возвращает список задач с информацией о назначенном пользователе и категории каждой задачи.

---

### 5. Получение задач, отсортированных по дате завершения

**Запрос:** `GET /api/tasks/sorted-by-due-date`

**Описание:** Получает задачи, отсортированные по дате завершения. Это позволяет пользователям видеть, какие задачи нужно завершить в первую очередь.

---

### 6. Получение истории изменений задачи по ID

**Запрос:** `GET /api/tasks/{taskId}/history`

**Описание:** Возвращает историю изменений конкретной задачи по её ID. Это позволяет отслеживать все изменения, сделанные с задачей.

---

### 7. Получение комментариев по задаче с фильтрацией по пользователю

**Запрос:** `GET /api/tasks/{taskId}/comments?userId={userId}`

**Описание:** Получает комментарии к задаче, отфильтрованные по указанному пользователю. Это позволяет пользователям увидеть только те комментарии, которые они оставили.

---

### 8. Получение вложений по задаче с информацией о пользователе

**Запрос:** `GET /api/tasks/{taskId}/attachments`

**Описание:** Возвращает все вложения по задаче с информацией о пользователе, который прикрепил файл. Это удобно для отслеживания всех файлов, связанных с задачей.

---

### 9. Получение задач с фильтрацией по дате завершения

**Запрос:** `GET /api/tasks/due-date?start={startDate}&end={endDate}`

**Описание:** Получает задачи, которые должны быть завершены в указанный период. Это полезно для планирования задач на будущее.

---

### 10. Получение задач с учётом статуса завершения и приоритета

**Запрос:** `GET /api/tasks?isCompleted={isCompleted}&priority={priority}`

**Описание:** Возвращает задачи, фильтруемые по статусу завершения и приоритету. Это позволяет пользователям находить задачи, соответствующие их критериям.

---

## API Эндпоинты

### Пользователи

- `GET /api/Users`: Получить всех пользователей.
- `GET /api/Users/{id}`: Получить пользователя по ID.
- `POST /api/Users`: Добавить нового пользователя.
- `PUT /api/Users`: Обновить пользователя.
- `DELETE /api/Users/{id}`: Удалить пользователя по ID.

### Категории

- `GET /api/Categories`: Получить все категории.
- `GET /api/Categories/{id}`: Получить категорию по ID.
- `POST /api/Categories`: Добавить новую категорию.
- `PUT /api/Categories`: Обновить категорию.
- `DELETE /api/Categories/{id}`: Удалить категорию по ID.

### Задачи

- `GET /api/Tasks`: Получить все задачи.
- `GET /api/Tasks/{id}`: Получить задачу по ID.
- `POST /api/Tasks`: Добавить новую задачу.
- `PUT /api/Tasks`: Обновить задачу.
- `DELETE /api/Tasks/{id}`: Удалить задачу по ID.

### Комментарии

- `GET /api/Comments`: Получить все комментарии.
- `GET /api/Comments/{id}`: Получить комментарий по ID.
- `POST /api/Comments`: Добавить новый комментарий.
- `PUT /api/Comments`: Обновить комментарий.
- `DELETE /api/Comments/{id}`: Удалить комментарий по ID.

### Вложения

- `GET /api/Attachments`: Получить все вложения.
- `GET /api/Attachments/{id}`: Получить вложение по ID.
- `POST /api/Attachments`: Добавить новое вложение.
- `PUT /api/Attachments`: Обновить вложение.
- `DELETE /api/Attachments/{id}`: Удалить вложение по ID.

### История изменений

- `GET /api/Histories`: Получить всю историю изменений.
- `GET /api/Histories/{id}`: Получить историю изменений по ID.
- `POST /api/Histories`: Добавить новую запись в историю изменений.
- `PUT /api/Histories`: Обновить запись в истории изменений.
- `DELETE /api/Histories/{id}`: Удалить запись из истории изменений по ID.